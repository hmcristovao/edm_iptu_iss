name: ğŸ§ª Testes Pytest (CI/CD)

# Roda em pushs e Pull Requests para a branch principal (main)
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  # Usaremos 'build' para consistÃªncia com seus logs de erro anteriores
  build: 
    name: ğŸ Testes Python ${{ matrix.python-version }}
    runs-on: ubuntu-latest
    
    # Executa o mesmo job em diferentes versÃµes do Python
    strategy:
      matrix:
        python-version: [ '3.12' ]

    steps:
    - name: â¬‡ï¸ Checkout do RepositÃ³rio
      # Baixa seu cÃ³digo.
      uses: actions/checkout@v4

    - name: ğŸ› ï¸ Configurar Python ${{ matrix.python-version }}
      uses: actions/setup-python@v4 # Usando v4, que Ã© menos rigorosa
      with:
        python-version: ${{ matrix.python-version }}
        # Linha CRÃTICA: Desativa o cache explicitamente para IGNORAR a busca por requirements.txt.
        cache: 'none' 

    - name: ğŸ“¦ Instalar Ferramentas de Teste (Pytest, Pandas, Mock)
      run: |
        # Garante que o pip esteja atualizado
        python -m pip install --upgrade pip
        
        # Instala as dependÃªncias de teste diretamente
        pip install pytest pandas mock

    - name: ğŸ§ª Executar Testes
      run: |
        # Executa o pytest com modo detalhado (verbose)
        pytest -v --log-cli-level=INFO
