name: ğŸ§ª Testes Pytest (CI/CD)

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  # Usaremos 'build' aqui para corresponder aos logs de erro que vocÃª enviou,
  # garantindo consistÃªncia com o que o runner estÃ¡ chamando.
  build: 
    name: ğŸ Testes Python ${{ matrix.python-version }}
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        python-version: [ '3.10', '3.11', '3.12' ]

    steps:
    - name: â¬‡ï¸ Checkout do RepositÃ³rio
      uses: actions/checkout@v4

    # MUDANÃ‡A CRÃTICA: Usando a versÃ£o v4 para maior tolerÃ¢ncia de cache
    - name: ğŸ› ï¸ Configurar Python ${{ matrix.python-version }}
      uses: actions/setup-python@v4 # <-- ALTERADO PARA V4
      with:
        python-version: ${{ matrix.python-version }}

    - name: ğŸ“¦ Instalar Ferramentas de Teste (Pytest, Pandas, Mock)
      run: |
        python -m pip install --upgrade pip
        # Instala as dependÃªncias necessÃ¡rias para os seus testes
        pip install pytest pandas mock

    - name: ğŸ§ª Executar Testes
      run: |
        pytest -v --log-cli-level=INFO
